# Version 0.1

**This is not backwards compatible with version 0.1.**

 * *Requires Go 1.4.*
 * Move files to separate directories.
 * Add empty cgo directory for future development. Only has note.
 * More constants added.
 * Change **variables** and **constants** to match Go naming idioms.
 * Create COM Generate readme.md to describe command line tool.
 * COM Interfaces have been moved to their own packages.
 * `oleutil` was removed. It is now part of the `api` library.
 * `connect` was removed. It is now part of the COM generate tool.
 * Interface packages can be served by COM.

## COM Generate Tool

The COM generate tool is new to version 0.2 and allows for generating Go code based off of COM type library information. This is used within the COM library to generate code to reduce the time it takes to implement a COM interface and keep the code uniform throughout.

## Interface Packages

Each COM interface has its own package. The package is split into files that should be autogenerated and files that need to be manually edited.

Each package is standardize with the following components.
 * `VirtualTable` for references (pointers) to object methods.
 * Optional `InterfaceID` GUID variable that references the IID for the COM interface.
 * Structure type based on `iunknown.Unknown` that has a reference to the object virtual table.
 * Interface type that defines the type methods for the COM interface for Go.
 * `VTable()` type method that returns the `VirtualTable`.
 * Type methods that implements the COM Go interface type for structure based on `iunknown.Unknown`. These type methods use the client methods of the package or other packages.
 * `Doc.go` that provides a simple guide to using the package interface.
 * COM client methods (`client.go`) that may need to be manually implemented. The methods names and parameters are auto generated, but will need to be implemented.
 * COM client tests and examples in `client_test.go`.
 * COM server methods (`server.go`) that may need to be manually implemented. The methods names and parameters are auto generated, but will need to be implemented.
 * COM server tests and examples in `server_test.go`.
 * `VirtualTableService()` function that returns references to COM server `*Service()` functions. This can be auto generated.
 * *I**Interface**Service()* function that returns COM server reference object for `IUnknown` or another COM Interface object.

## Backwards Incompatible Changes

 * `CoInitialize()` accepts no parameters.
 * `CoInitializeEx()` accepts one parameter; the parameter is the currency type.
 * `VT` is now `VariantType`.
 * `CLSIDFromProgID()` is now `ClassIDFromProgramID()`.
 * `CLSIDFromString()` is now `ClassIDFromString()`.
 * `CreateInstance()` is now `CoCreateInstance()`.
 * Many of the constants have been renamed and are typed. You will need to convert before using in places where the native value would have been acceptable.

### COM Interface Casting

Version 0.1.x casted directly to IUnknown and IDispatch in some places. These were really, the only interfaces that were supported by the library. The changes to the API allows for casting to any known COM interace, but the parameter changes removes backwards compatibility with previous version.

This is what you would use in version 0.1.x:

```golang
clsid, _ = CLSIDFromProgID("...")
unknown, _ := CreateInstance(clsid, IID_IUnknown)
```

This changes in version 0.2.x and you must have the correct IID along with the structure. The name of the function has also changed.

```golang
clsid, _ = ClassIDFromProgramID("...")
var unknown IUnknown
CreateInstance(clsid, IID_IUnknown, &unknown) // Ignore error.
```

This change allows for supporting custom COM interfaces and other default COM interfaces without directly supporting them in the code.
